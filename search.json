[{"path":"https://dhercar.github.io/gdmmTMB/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 gdmmTMB authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/articles/modelling_community_uniqueness.html","id":"modelling-linear-effects-on-community-uniqueness","dir":"Articles","previous_headings":"","what":"Modelling linear effects on community uniqueness","title":"Modelling community uniqueness with `gdmmTMB`","text":"Community uniqueness often modelled Local Contribution Beta Diversity (Legendre De Cáceres 2013). common approach (1) compute LCBD scores dissimilarity matrix (2) model LCBD scores independent observations. code computes LCBD scores using package adespatial (Dray et al. 2018), regresses pH quadratic pH term.  brief, effects LCBD denote increasing decreasing expected dissimilarities community communities. U-shaped relationship therefore indicates communities extremes pH gradient dissimilar average communities, therefore unique. can obtain exact relationship modelling pairwise dissimilarities directly, introducing site-level effects (see Hernández-Carrasco et al. (2025) details). can done gdmmTMB via uniq_formula argument:  models produce exact U-shaped relationship pH LCBD. However, modelling effects uniqueness pairwise dissimilarities allows accounting distribution dissimilarities appropriate error distribution link function. instance, binomial error distribution can specified via family argument. can also account non-independence pairwise dissimilarities site-level random effect (uniq_formula = ~ ... + (1|site)), Bayesian bootstrapping (bboot = TRUE):","code":"LCBD <- adespatial::LCBD.comp(vegan::vegdist(Y)) Xenv$LCBD <- LCBD$LCBD  m_lcbd <- lm(LCBD~poly(pH,2), data = Xenv) Xenv$pred_lcbd <- predict(m_lcbd)  ggplot(Xenv , aes(x = pH, y = LCBD)) +    geom_point() +    geom_line(aes(y = pred_lcbd)) +    theme(aspect.ratio = 1) # fit model m_gdmm <-   gdmm(Y = Y,        X = Xenv,        uniq_formula = ~ poly(pH, 2)) #> Warning: the 'nobars' function has moved to the reformulas package. Please update your imports, or ask an upstream package maintainter to do so. #> This warning is displayed once per session.  # generate predictions Xenv$pred_gdmm <- predict(m_gdmm, component = 'uniqueness', scale_uniq = TRUE, CI = F)  # Plot relationship ggplot(Xenv , aes(x = pH, y = LCBD)) +    geom_point() +    geom_line(aes(y = pred_gdmm, col = 'gdmm'), linewidth = 2, alpha = 0.7) +    geom_line(aes(y = pred_lcbd, col = 'lcbd')) +    theme(aspect.ratio = 1,         legend.position = 'bottom') Xenv$site <- as.factor(1:nrow(Xenv))  # site-level random effect m_gdmm2 <- gdmm(   Y = Y,   X = Xenv,   uniq_formula = ~ poly(pH, 2) + (1 | site),   family = 'binomial')  # Bayesian bootstrapping m_gdmm3 <- gdmm(   Y = Y,   X = Xenv,   uniq_formula = ~ poly(pH, 2),   family = 'binomial',   bboot = TRUE)"},{"path":"https://dhercar.github.io/gdmmTMB/articles/modelling_community_uniqueness.html","id":"accounting-for-directional-community-changes","dir":"Articles","previous_headings":"","what":"Accounting for directional community changes","title":"Modelling community uniqueness with `gdmmTMB`","text":"U-shaped relationship LCBD pH indicates sites low high pH host relatively unique species. However, representation variability community composition reveals strong directional change community composition along pH gradient.  Sites either end pH gradient therefore centroid (.e., present higher average dissimilarity sites), underpin U-shaped relationship LCBD pH. refer contribution directional changes community composition observed beta diversity patterns ‘directional effects’. Directional effects can accounted making expected dissimilarity sites function environmental distance (Mokany et al. 2022). gdmmTMB, directional effects introduced via diss_formula argument: diss_gradient function can used visualise dissimilarity gradients.  can also use predict method visualise new expected relationship pH LCBD, contributions model component (directional non-directional effects):","code":"m_gdmm3 <- gdmm(   Y = Y,   X = Xenv,   uniq_formula = ~ poly(pH, 2),   diss_formula = ~ isp(pH),   family = 'binomial',   bboot = TRUE,   mono = TRUE) diss_grad <- diss_gradient(m_gdmm3)  ggplot(do.call(rbind, diss_grad), aes(x = x, y = f_x))  +   geom_line() +   geom_ribbon(aes(ymin = `CI 2.5%`, ymax = `CI 97.5%`), alpha = 0.3) +    xlab('pH') +   ylab('f(pH)') newdata_mean = data.frame(pH = rep(mean(Xenv$pH), nrow(Xenv)))  predict_tot <- data.frame(   predict(m_gdmm3, new_X = Xenv, new_W = Xenv, component = 'uniqueness'),    pH = Xenv$pH,   LCBD = Xenv$LCBD)  predict_dir <- data.frame(   predict(m_gdmm3, new_X = Xenv, new_W = newdata_mean, component = 'uniqueness'),    pH = Xenv$pH,   LCBD = Xenv$LCBD)  predict_nondir <- data.frame(   predict(m_gdmm3, new_X = newdata_mean, new_W = Xenv, component = 'uniqueness'),    pH = Xenv$pH,   LCBD = Xenv$LCBD)"},{"path":[]},{"path":"https://dhercar.github.io/gdmmTMB/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Daniel Hernandez-Carrasco. Author, maintainer.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hernandez-Carrasco D (2026). gdmmTMB: Generalised Dissimilarity Mixed Models R Using TMB. R package version 0.0.0.9000, https://dhercar.github.io/gdmmTMB/.","code":"@Manual{,   title = {gdmmTMB: Generalised Dissimilarity Mixed Models in R Using TMB},   author = {Daniel Hernandez-Carrasco},   year = {2026},   note = {R package version 0.0.0.9000},   url = {https://dhercar.github.io/gdmmTMB/}, }"},{"path":"https://dhercar.github.io/gdmmTMB/index.html","id":"gdmmtmb","dir":"","previous_headings":"","what":"Generalised Dissimilarity Mixed Models in R Using TMB","title":"Generalised Dissimilarity Mixed Models in R Using TMB","text":"package gdmmTMB provides functions fitting interrogating Generalised Dissimilarity Mixed Models (GDMM) using maximum likelihood estimation, Laplace approximation (optionally) Bayesian Bootstrapping.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Generalised Dissimilarity Mixed Models in R Using TMB","text":"package can installed GitHub using devtools::install_github:","code":"devtools::install_github('dhercar/gdmmTMB')"},{"path":"https://dhercar.github.io/gdmmTMB/index.html","id":"usage-example","dir":"","previous_headings":"","what":"Usage example","title":"Generalised Dissimilarity Mixed Models in R Using TMB","text":"package gdmmTMB designed primarily analysis ecological datasets set environmental variables used explain variability species composition. example, use two datasets available part gdm package. start two matrices: sp: community matrix (site x species) env: matrix environmental covariates. use bio6, bio15, bio19 explanatory variables. Monotonic -splines dissimilarity gradients (diss_formula) specified via isp(x) mono = TRUE. resulting non-linear transformations reflect degree directional community change along environmental gradient. specify binomial error family model Jaccard dissimilarities, yij=bi+bjaij+bi+bj, y_{ij} = \\frac{b_i + b_j}{a_{ij} + b_i + b_j}, dissimilarity observations ii jj depends number unshared (bi,bjb_i, b_j) shared (aija_{ij}) species. specifying binomial distribution, Jaccard dissimilarity index modelled probability π\\pi randomly chosen species combined species pool (aij+bi+bja_{ij} + b_i + b_j) shared observations ii jj.","code":"library(tidyverse) library(gdmmTMB)  sp <- gdm::southwest %>% select(site, species) %>%    group_by(site, species) %>%   summarise(n = 1) %>%   pivot_wider(id_cols = site, names_from = species,values_from = n, values_fill = 0) %>%   arrange(site)  env <- gdm::southwest %>% select(-c(species)) %>%   distinct() %>% arrange(site) m <- gdmm(Y = sp[,-1],           X = env,           diss_formula = ~ isp(bio6) + isp(bio15) + isp(bio19),           family = 'binomial',           method = 'jaccard',           n_boot = 100, # should be at least 1000           bboot = TRUE,           mono = TRUE) ## Running bayesian bootstrapping on 14 cores ...done"},{"path":"https://dhercar.github.io/gdmmTMB/index.html","id":"model-summary","dir":"","previous_headings":"","what":"Model summary","title":"Generalised Dissimilarity Mixed Models in R Using TMB","text":"summary method gdmmTMB provides general information model, including estimated coefficients, credible confidence intervals, common metrics used model selection AIC BIC.","code":"summary(m) ## --------------------------------------------------------------------------------  ##                                  BBGDMM SUMMARY  ## --------------------------------------------------------------------------------  ##  ## call: ##  ##  gdmm(Y = sp[, -1], X = env, diss_formula = ~isp(bio6) + isp(bio15) +     isp(bio19), mono = TRUE, family = \"binomial\", method = \"jaccard\",     bboot = TRUE, n_boot = 100) ##  ## --------------------------------- Coeff. Table ---------------------------------  ##  ##                    Estimate  Std.Err.      2.5%       50%     97.5% pseudo-Z ## diss: isp(bio6)1  3.217e-01 1.355e-01 8.045e-02 3.259e-01 6.025e-01   2.3740 ## diss: isp(bio6)2  1.341e-02 4.014e-02 1.010e-08 1.672e-08 1.598e-01   0.3340 ## diss: isp(bio6)3  1.750e-02 4.444e-02 1.000e-08 1.109e-08 1.448e-01   0.3937 ## diss: isp(bio15)1 8.631e-01 1.443e-01 5.817e-01 8.552e-01 1.143e+00   5.9792 ## diss: isp(bio15)2 1.210e-08 1.360e-08 1.000e-08 1.003e-08 1.341e-08   0.8896 ## diss: isp(bio15)3 1.246e-08 1.990e-08 1.000e-08 1.000e-08 1.253e-08   0.6259 ## diss: isp(bio19)1 1.876e+00 1.440e-01 1.609e+00 1.860e+00 2.143e+00  13.0284 ## diss: isp(bio19)2 1.412e-08 3.178e-08 1.000e-08 1.000e-08 1.240e-08   0.4442 ## diss: isp(bio19)3 1.627e-08 5.185e-08 1.000e-08 1.000e-08 2.131e-08   0.3139 ## (Intercept)       8.789e-01 7.069e-02 7.537e-01 8.739e-01 1.012e+00  12.4331 ##                   pseudo-Pval     ## diss: isp(bio6)1       < 0.01 *** ## diss: isp(bio6)2       < 0.01 *** ## diss: isp(bio6)3       < 0.01 *** ## diss: isp(bio15)1      < 0.01 *** ## diss: isp(bio15)2      < 0.01 *** ## diss: isp(bio15)3      < 0.01 *** ## diss: isp(bio19)1      < 0.01 *** ## diss: isp(bio19)2      < 0.01 *** ## diss: isp(bio19)3      < 0.01 *** ## (Intercept)            < 0.01 ***  ##  ## CAUTION: P-values for dissimilarity components (diss) should not be used for hypothesis testing when \"mono = TRUE\"  ## --- ## signif. codes: '***' <0.001 '**' <0.01 '*' <0.05 '.' <0.1  ## --- ##  ## Marginal log-likelihood (average):  -27848.53  ## AIC:  55717.06 , AICc:  55717.11 , BIC:  55780.88  ##  ## --------------------------------------------------------------------------------"},{"path":"https://dhercar.github.io/gdmmTMB/index.html","id":"plot-dissimilarity-gradients","dir":"","previous_headings":"","what":"Plot dissimilarity gradients","title":"Generalised Dissimilarity Mixed Models in R Using TMB","text":"Predictors ‘diss_formula’ treated environmental distances, contribution expected dissimilarity depends distance samples (optionally) transformations applied. instance, isp(bio6) mono = TRUE defines non-linear, monotonic change community composition generates increasing dissimilarities increasing distance along gradient (dissimilarity gradient).shape resulting function can informative degree directional community change environmental variable responsible . function diss_gradient provides list dissimilarity gradients confidence credible intervals, can easily combined plotted: Note argument CI_quant specifies coverage confidence credible interval, quantiles (e.g., 0.95 implies quantiles 0.025 0.975). therefore specified 50% 95% credible credible intervals.  plot shows relationship variable (xx) variable applying monotonic, non-linear transformation (f(x)f(x)). Steeper increases f(x)f(x) correspond fast community change.","code":"f_x <- diss_gradient(m, CI_quant = c(0.5, 0.95)) library(ggplot2)  do.call(rbind, f_x) %>% ggplot(aes(fill = var)) +   theme_bw() +   geom_line(aes(x = x, y = f_x)) +   geom_ribbon(aes(x = x, ymax = `CI 2.5%`, ymin = `CI 97.5%`), alpha = 0.1) +   geom_ribbon(aes(x = x, ymax = `CI 25%`, ymin = `CI 75%`), alpha = 0.3) +   facet_wrap(~var, scales = 'free_x', strip.position = \"bottom\") +   ylab('f(x)') +   theme(strip.placement = 'outside',          panel.grid = element_blank(),         strip.background = element_blank(),         aspect.ratio = 1)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/AICc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate AICc — AICc","title":"Calculate AICc — AICc","text":"Calculates Akaike Information Criterion corrected small sample sizes (AICc).","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/AICc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate AICc — AICc","text":"","code":"AICc(log_likelihood, n, k)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/AICc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate AICc — AICc","text":"log_likelihood log-likelihood model n number observations k number estimated parameters","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/BIC2.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Information Criterion (BIC) — BIC2","title":"Bayesian Information Criterion (BIC) — BIC2","text":"Calculates Bayesian Information Criterion (BIC).","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/BIC2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Information Criterion (BIC) — BIC2","text":"","code":"BIC2(log_likelihood, n, k)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/BIC2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Information Criterion (BIC) — BIC2","text":"log_likelihood log-likelihood model n number observations k number estimated parameters","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/SS_calc.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","title":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","text":"Computes per-site sum squares (SS) symmetric dissimilarity matrix using double-centering. Optionally returns LCBD values (relative contributions total SS).","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/SS_calc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","text":"","code":"SS_calc(x, LCBD = FALSE)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/SS_calc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","text":"x numeric symmetric matrix (e.g., squared Euclidean dissimilarity matrix). LCBD Logical; TRUE, returns normalized values summing 1 (LCBD).","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/SS_calc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","text":"numeric vector length nrow(x). LCBD = TRUE, values sum 1.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/SS_calc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Sum of Squares or LCBD from a Symmetric Dissimilarity Matrix — SS_calc","text":"function double-centers dissimilarity matrix x extracts diagonal elements. LCBD = TRUE, diagonal normalized sum 1.","code":""},{"path":[]},{"path":"https://dhercar.github.io/gdmmTMB/reference/bray1.html","id":null,"dir":"Reference","previous_headings":"","what":"Bray-Curtis dissimilarity components — bray1","title":"Bray-Curtis dissimilarity components — bray1","text":"Calculate numerator denominator components Bray-Curtis dissimilarity index. Bray-Curtis dissimilarity calculated \\(\\frac{\\sum_{} |x_i - y_i|}{\\sum_{} (x_i + y_i)}\\)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/bray1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bray-Curtis dissimilarity components — bray1","text":"","code":"bray1(x, y)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/bray1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bray-Curtis dissimilarity components — bray1","text":"x numeric vector first sample compared y numeric vector second sample compared","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/bray1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bray-Curtis dissimilarity components — bray1","text":"named numeric vector two elements: num - numerator: sum absolute differences x y den - denominator: sum x y values","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/coef_to_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert model coefficients to predictions — coef_to_pred","title":"Convert model coefficients to predictions — coef_to_pred","text":"Internal function transforms model parameters new data dissimilarity uniqueness predictions.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/coef_to_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert model coefficients to predictions — coef_to_pred","text":"","code":"coef_to_pred(   object,   intercept,   beta,   beta_p,   lambda,   u,   new_W,   new_X,   new_X_pair,   new_re,   D,   n,   component,   scale_uniq,   type,   sigma )"},{"path":"https://dhercar.github.io/gdmmTMB/reference/coef_to_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert model coefficients to predictions — coef_to_pred","text":"object Model object containing fitted model components intercept Numeric, model intercept beta Numeric vector, coefficients dissimilarity component beta_p Numeric vector, coefficients dissimilarity component (pairwise) lambda Numeric vector, coefficients uniqueness component u Numeric vector, random effect values new_W Matrix/data.frame, new data uniqueness component new_X Matrix/data.frame, new data dissimilarity component new_X_pair Matrix/data.frame, new data dissimilarity component (pairwise) new_re Matrix/data.frame, new random effect data D Matrix, pairwise combination indices n Integer, number observations component Character, \"dissimilarity\" \"uniqueness\" scale_uniq Logical, whether scale uniqueness values type Character, \"response\" \"link\" scale sigma Numeric, random effect standard deviations","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/coef_to_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert model coefficients to predictions — coef_to_pred","text":"Numeric vector predictions (dissimilarities uniqueness values)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/diss_gradient.html","id":null,"dir":"Reference","previous_headings":"","what":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","title":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","text":"Computes predicted effect one covariates compositional dissimilarity fitted gdmm bbgdmm model. Optionally, returns uncertainty bands (credible confidence intervals) using either bootstrapped samples parametric bootstrapping.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/diss_gradient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","text":"","code":"diss_gradient(   m,   var = \"all\",   n = 100,   CI = TRUE,   n_sim = NULL,   CI_quant = c(0.95) )"},{"path":"https://dhercar.github.io/gdmmTMB/reference/diss_gradient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","text":"m fitted model object class gdmm bbgdmm. var Character vector variable names evaluate. Use \"\" (default) use predictors model. n Integer. Number points evaluate along gradient. Defaults 100. CI Logical. Whether compute confidence intervals. Default TRUE. n_sim Number draws used obtain CI. NULL, uses n_boot bbgdmm objects 1000 gdmm. CI_quant Numeric vector specifying quantile coverage (e.g., 0.95 95% CI). Default 0.95.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/diss_gradient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","text":"named list data frames, one variable var. data frame contains: var: Variable names. f_x: Predicted value fitted non-linear transformation (e.g., monotonic -splines). x: values focal gradient. CI lower / CI upper: (Optional) Lower upper bounds confidence interval.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/diss_gradient.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predicted Effects of Environmental Gradients on Dissimilarity — diss_gradient","text":"function generates predicted dissimilarities along gradient specified predictor, holding predictors constant. CI = TRUE, uses bootstrap samples (bbgdmm) simulates joint covariance matrix (gdmm) construct confidence credible intervals. approach useful visualizing directional compositional changes along individual environmental gradients.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/gdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Generalized Dissimilarity Mixed Model (GDMM). — gdmm","title":"Fit Generalized Dissimilarity Mixed Model (GDMM). — gdmm","text":"Fits generalized dissimilarity mixed model (gdmm) ecological community data. model can estimate effect predictors community dissimilarity uniqueness simultaneously. function supports two options estimation: Hierarchical structure via site-level random effects uniq_formula (e.g., ~ ... + (1|site)). Bayesian bootstrapping (bboot = TRUE) obtain site-level uncertainty parameter estimates. Dissimilarity gradients specified diss_formula, may include non-linear transformations monotonic -splines (isp(x) mono = TRUE) allow flexible monotonic responses. Direct effects community uniqueness supported via uniq_formula.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/gdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Generalized Dissimilarity Mixed Model (GDMM). — gdmm","text":"","code":"gdmm(   Y = NULL,   Y_diss = NULL,   Y_den = 0,   D = NULL,   X = NULL,   X_pair = NULL,   diss_formula = NULL,   uniq_formula = NULL,   pair_formula = NULL,   mono = FALSE,   mono_pair = FALSE,   family = \"normal\",   link = NULL,   scale_diss = NULL,   binary = FALSE,   method = \"bray\",   control = NULL,   trace = FALSE,   bboot = FALSE,   n_boot = 1000,   n_cores = NULL )"},{"path":"https://dhercar.github.io/gdmmTMB/reference/gdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Generalized Dissimilarity Mixed Model (GDMM). — gdmm","text":"Y Response matrix (e.g., site x species matrix). Either Y Y_diss must provided. Y_diss Pre-calculated dissimilarity values site pairs. provided, D must also supplied. Either Y Y_diss must provided. Y_den Denominator values Jaccard, Sørensenensen Bray-Curtis dissimilarities using Y_diss. Required family = \"binomial\" Y_diss provided. D Data frame matrix two columns specifying site pairs (indices) corresponding Y_diss values. required Y_diss provided. X Data frame containing predictor variables site-level values. X_pair Data frame containing predictor variables pairwise distances. diss_formula Formula specifying predictors dissimilarity gradients. variables must numeric. isp() can used combination mono = TRUE fit monotonic -splines (e.g., ~ isp(elevation) + isp(temperature)). uniq_formula Formula specifying predictors random effects uniqueness. Uses lme4-style syntax random effects (e.g., ~ treatment + (1|site)). pair_formula Formula specifying predictors dissimilarity gradients. Variables must numeric. mono Logical. TRUE, enforces monotonic (non-decreasing) dissimilarity effects predictors included diss_formula. Default FALSE. mono_pair Logical. TRUE, enforces monotonic (non-decreasing) dissimilarity effects predictors included pair_formula. Default FALSE. family Distribution family response. One \"normal\", \"binomial\", \"beta\". Default \"normal\". link Link function. NULL (default), automatically chosen based family: \"identity\" normal, \"logit\" binomial/beta. scale_diss Numeric vector length 2 specifying range re-scaling dissimilarity values. Useful using beta distribution dissimilarities exactly 0 /1. binary Logical. Whether treat response binary data calculating dissimilarities Y. Default FALSE. method Dissimilarity method applied Y. See vegan::vegdist() list compatible methods. Default \"bray\". control List control parameters passed nlminb optimizer (e.g., control = list(rel.tol = 1e-8, iter.max = 500)). trace Logical. TRUE, prints information optimization. Default FALSE. bboot Logical. TRUE, performs Bayesian bootstrapping. Default FALSE. n_boot Integer. Number bootstrap samples bboot = TRUE. Default 1000. n_cores Integer. Number cores parallel processing bootstrapping. NULL, uses detectCores() - 2.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/gdmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Generalized Dissimilarity Mixed Model (GDMM). — gdmm","text":"bboot = FALSE: object class \"gdmm\" containing model fit, parameters, diagnostics. bboot = TRUE: object class \"bbgdmm\" containing bootstrap samples model information.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/inv_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse logit — inv_logit","title":"Inverse logit — inv_logit","text":"Performs inverse logit: exp(x) / (1 + exp(x))","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/inv_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse logit — inv_logit","text":"","code":"inv_logit(x)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/inv_logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse logit — inv_logit","text":"x numeric value vector","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/inv_logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse logit — inv_logit","text":"(transformed) numeric value vector","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/isp.html","id":null,"dir":"Reference","previous_headings":"","what":"Ispline Basis with Degree 2 by Default — isp","title":"Ispline Basis with Degree 2 by Default — isp","text":"thin wrapper around splines2::isp(). Uses degree = 2 unless otherwise specified. arguments passed .","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/isp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ispline Basis with Degree 2 by Default — isp","text":"","code":"isp(x, degree = 2, ...)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/isp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ispline Basis with Degree 2 by Default — isp","text":"x numeric vector. degree Spline degree; defaults 2 (instead 3). ... additional parameters passed splines2::isp","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/make_y_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Format community data — make_y_df","title":"Format community data — make_y_df","text":"Formats species x site table long data frame community dissimilarities","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/make_y_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format community data — make_y_df","text":"","code":"make_y_df(   com = NULL,   D = NULL,   id = NULL,   method = \"bray\",   num_den = FALSE,   trans = NULL,   drop_empty_rows = FALSE,   drop_empty_cols = TRUE,   binary = FALSE,   check_trans = TRUE,   na.rm = FALSE,   na.replace = NULL )"},{"path":"https://dhercar.github.io/gdmmTMB/reference/make_y_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format community data — make_y_df","text":"com community matrix (sites x species) D Optional. Numeric matrix two columns id Optional. Unique id sample method Method used calculate community dissimilarity pairs sites. Either distance metric supported vegan, 'abcd' obtain component binary contingecy matrix, 'decomp1' 'decomp2' Pierre Legendre's Andres Baselga's turnover nestedness decomposition num_den dissimilarity indices, whether function return numerator denominator two different columns trans Transformation applied raw data calculating distance matrix. Either function 'binary' transform presence-absence) drop_empty_rows Indicates whether empty rows (.e., sites containing 0s ) removed drop_empty_cols Indicates whether empty columns (.e., species without observations) removed binary Indicates whether abundance data transform presence absence check_trans Check non-finite values transformation na.rm Remove rows NA? na.replace Replace NAs specific value","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/make_y_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format community data — make_y_df","text":"data frame following columns s1, s2  -  combination sites (rows). Additional columns indicating dissimilarity sites.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for gdmm and bbgdmm objects — predict.gdmm","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"Generate predictions fitted generalized dissimilarity mixed models. method can predict dissimilarity uniqueness new data, optional confidence intervals. Works regular gdmm bootstrap bbgdmm objects.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"","code":"# S3 method for class 'gdmm' predict(   object,   new_X = NULL,   new_W = NULL,   new_X_pair = NULL,   new_re = NULL,   new_D = NULL,   re_sd = logical(0),   component = \"dissimilarity\",   scale_uniq = TRUE,   type = \"response\",   CI = TRUE,   CI_quant = c(0.95, 0.5),   n_sim = NULL,   n_cores = 1,   ... )  # S3 method for class 'bbgdmm' predict(   object,   new_X = NULL,   new_W = NULL,   new_X_pair = NULL,   new_re = NULL,   new_D = NULL,   re_sd = logical(0),   component = \"dissimilarity\",   scale_uniq = TRUE,   type = \"response\",   CI = TRUE,   CI_quant = c(0.95, 0.5),   n_sim = NULL,   n_cores = 1,   ... )"},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"object fitted model object class 'gdmm' 'bbgdmm' new_X data frame matrix new predictor variables dissimilarity component. NULL (default), uses original data fitted model. new_W data frame matrix new predictor variables uniqueness component. new_X_pair data frame matrix new pairwise predictor variables dissimilarity component, usually distances. new_re data frame new random effect variables. NULL, uses random effects fitted model new_D Matrix pairwise combination indices. Required new_X_pair provided. re_sd character indicating random effects treated standard deviation (used simulation). component Character string specifying predict. Either \"dissimilarity\" (default) pairwise dissimilarities \"uniqueness\" site-level uniqueness values. scale_uniq Logical indicating whether uniqueness values transformed proportions LCBD. Default TRUE. type Character string specifying type prediction. Either \"response\" (default) predictions response scale, \"link\" predictions linear predictor scale. CI Logical indicating whether compute confidence intervals. Default TRUE. CI_quant Numeric vector confidence levels compute. Default c(0.95, 0.5) 95% 50% confidence intervals. n_sim Integer specifying number simulations confidence intervals. NULL, uses 1000 'gdmm' objects number bootstrap samples 'bbgdmm' objects. n_cores Integer specifying number cores use parallel computation. Currently implemented. Default 1. ... Additional parameters (used).","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"CI = FALSE, returns numeric vector predictions. CI = TRUE, returns matrix columns mean prediction confidence interval bounds, named according confidence levels specified CI_quant.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"function generates predictions fitted gdmm models : Computing expected values using model coefficients Optionally generating confidence intervals bootstrapping 'gdmm' objects, confidence intervals computed using parametric bootstrapping. component = \"uniqueness\", function computes site-level uniqueness values based full dissimilarity matrix. component = \"dissimilarity\", returns pairwise dissimilarity predictions. site-level random effects included via uniq_formula fitting model (e.g.,uniq_formula = (1|site)), confidence intervals can incorporate site-level uncertainty via re_sd = c('site').","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/predict.gdmm.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Predict method for gdmm and bbgdmm objects — predict.gdmm","text":"predict(bbgdmm): Method bootstrap gdmm objects","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.bbgdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for bbgdmm objects — print.bbgdmm","title":"Print method for bbgdmm objects — print.bbgdmm","text":"Prints basic information fitted bbgdmm object","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.bbgdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for bbgdmm objects — print.bbgdmm","text":"","code":"# S3 method for class 'bbgdmm' print(x, ...)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.bbgdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for bbgdmm objects — print.bbgdmm","text":"x fitted model object class bbgdmm ... Additional parameters (used)","code":""},{"path":[]},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.gdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for gdmm objects — print.gdmm","title":"Print method for gdmm objects — print.gdmm","text":"Prints basic information fitted gdmm object","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.gdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for gdmm objects — print.gdmm","text":"","code":"# S3 method for class 'gdmm' print(x, ...)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/print.gdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for gdmm objects — print.gdmm","text":"x fitted model object class gdmm ... Additional parameters (used)","code":""},{"path":[]},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title.html","id":null,"dir":"Reference","previous_headings":"","what":"Nice titles for summary tables — print_title","title":"Nice titles for summary tables — print_title","text":"Nice titles summary tables","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nice titles for summary tables — print_title","text":"","code":"print_title(text, symb = \"-\", width = getOption(\"width\"))"},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nice titles for summary tables — print_title","text":"text Title display symb Symbol used title width Size console. Defaults current width.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Nice titles for summary tables — print_title","text":"character string (invisibly returned)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title2.html","id":null,"dir":"Reference","previous_headings":"","what":"Centered title with decorated side — print_title2","title":"Centered title with decorated side — print_title2","text":"Centered title decorated side","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Centered title with decorated side — print_title2","text":"","code":"print_title2(text, symb = \"-\", width = getOption(\"width\"))"},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Centered title with decorated side — print_title2","text":"text Title display symb Symbol used left right title width Size console. Defaults current width.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/print_title2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Centered title with decorated side — print_title2","text":"character string (invisibly returned)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/scale_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale a vector into an specified — scale_dist","title":"Scale a vector into an specified — scale_dist","text":"Given numeric vector x, function re-scales x interval [min, max].","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/scale_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale a vector into an specified — scale_dist","text":"","code":"scale_dist(x, new = c(0.01, 0.99))"},{"path":"https://dhercar.github.io/gdmmTMB/reference/scale_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale a vector into an specified — scale_dist","text":"x numeric vector new Numeric scalar: upper lower bound target interval. Default [0.01, 0.99].","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/scale_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale a vector into an specified — scale_dist","text":"numeric vector length x, values interval [min(new), max(new)].","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.bbgdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for bbgdmm objects — summary.bbgdmm","title":"Summary method for bbgdmm objects — summary.bbgdmm","text":"S3 method summarizing bbgdmm model fits.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.bbgdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for bbgdmm objects — summary.bbgdmm","text":"","code":"# S3 method for class 'bbgdmm' summary(object, quantiles = c(0.025, 0.5, 0.975), null_value = 0, ...)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.bbgdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for bbgdmm objects — summary.bbgdmm","text":"object object class bbgdmm. quantiles numeric vector quantiles display. null_value Value used pseudo p-value tests. ... additional arguments (used)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.bbgdmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for bbgdmm objects — summary.bbgdmm","text":"object class summary.bbgdmm.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.gdmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for gdmm objects — summary.gdmm","title":"Summary method for gdmm objects — summary.gdmm","text":"S3 method summarizing gdmm model fits.","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.gdmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for gdmm objects — summary.gdmm","text":"","code":"# S3 method for class 'gdmm' summary(object, ...)"},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.gdmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for gdmm objects — summary.gdmm","text":"object object class gdmm. ... additional arguments (used)","code":""},{"path":"https://dhercar.github.io/gdmmTMB/reference/summary.gdmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for gdmm objects — summary.gdmm","text":"object class summary.gdmm.","code":""}]
