% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_gdmm.R
\name{predict.gdmm}
\alias{predict.gdmm}
\alias{predict.bbgdmm}
\title{Predict method for gdmm and bbgdmm objects}
\usage{
\method{predict}{gdmm}(
  object,
  new_X = NULL,
  new_W = NULL,
  new_X_pair = NULL,
  new_re = NULL,
  new_D = NULL,
  re_sd = logical(0),
  component = "dissimilarity",
  scale_uniq = TRUE,
  type = "response",
  CI = TRUE,
  CI_quant = c(0.95, 0.5),
  n_sim = NULL,
  n_cores = 1,
  ...
)

\method{predict}{bbgdmm}(
  object,
  new_X = NULL,
  new_W = NULL,
  new_X_pair = NULL,
  new_re = NULL,
  new_D = NULL,
  re_sd = logical(0),
  component = "dissimilarity",
  scale_uniq = TRUE,
  type = "response",
  CI = TRUE,
  CI_quant = c(0.95, 0.5),
  n_sim = NULL,
  n_cores = 1,
  ...
)
}
\arguments{
\item{object}{A fitted model object of class 'gdmm' or 'bbgdmm'}

\item{new_X}{A data frame or matrix of new predictor variables for the dissimilarity component.
If NULL (default), uses the original data from the fitted model.}

\item{new_W}{A data frame or matrix of new predictor variables for the uniqueness component.}

\item{new_X_pair}{A data frame or matrix of new pairwise predictor variables for the dissimilarity component, usually distances.}

\item{new_re}{A data frame of new random effect variables. If NULL, uses random effects in the fitted model}

\item{new_D}{Matrix of pairwise combination indices. Required when new_X_pair is provided.}

\item{re_sd}{A character indicating which random effects should be treated as having
standard deviation (used for simulation).}

\item{component}{Character string specifying what to predict. Either "dissimilarity" (default)
for pairwise dissimilarities or "uniqueness" for site-level uniqueness values.}

\item{scale_uniq}{Logical indicating whether uniqueness values should be transformed into proportions as in LCBD. Default is TRUE.}

\item{type}{Character string specifying the type of prediction. Either "response" (default)
for predictions on the response scale, or "link" for predictions on the linear predictor scale.}

\item{CI}{Logical indicating whether to compute confidence intervals. Default is TRUE.}

\item{CI_quant}{Numeric vector of confidence levels to compute. Default is \code{c(0.95, 0.5)}
for 95\% and 50\% confidence intervals.}

\item{n_sim}{Integer specifying the number of simulations for confidence intervals.
If NULL, uses 1000 for 'gdmm' objects and the number of bootstrap samples for 'bbgdmm' objects.}

\item{n_cores}{Integer specifying the number of cores to use for parallel computation.
Currently not implemented. Default is 1.}

\item{...}{Additional parameters (not used).}
}
\value{
If \code{CI = FALSE}, returns a numeric vector of predictions.
If \code{CI = TRUE}, returns a matrix with columns for the mean prediction and
confidence interval bounds, named according to the confidence levels specified in \code{CI_quant}.
}
\description{
Generate predictions from fitted generalized dissimilarity mixed models.
This method can predict dissimilarity or uniqueness for new data,
with optional confidence intervals. Works with both regular gdmm and bootstrap bbgdmm objects.
}
\details{
This function generates predictions from fitted gdmm models by:
\itemize{
\item Computing expected values using model coefficients
\item Optionally generating confidence intervals through bootstrapping
}

For 'gdmm' objects, confidence intervals are computed using parametric bootstrapping.

When \code{component = "uniqueness"}, the function computes site-level uniqueness
values based on the full dissimilarity matrix. When \code{component = "dissimilarity"},
it returns pairwise dissimilarity predictions.
If site-level random effects are included via \code{uniq_formula} when fitting the model (e.g.,\code{uniq_formula = (1|site)}),
confidence intervals can incorporate site-level uncertainty via \code{re_sd = c('site')}.
}
\section{Functions}{
\itemize{
\item \code{predict(bbgdmm)}: Method for bootstrap gdmm objects

}}
