% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_gdmm.R
\name{gdmm}
\alias{gdmm}
\title{Fit Generalized Dissimilarity Mixed Model (GDMM).}
\usage{
gdmm(
  Y = NULL,
  Y_diss = NULL,
  Y_den = 0,
  D = NULL,
  X = NULL,
  X_pair = NULL,
  diss_formula = NULL,
  uniq_formula = NULL,
  pair_formula = NULL,
  mono = FALSE,
  mono_pair = FALSE,
  family = "normal",
  link = NULL,
  scale_diss = NULL,
  binary = FALSE,
  method = "bray",
  control = NULL,
  trace = FALSE,
  bboot = FALSE,
  n_boot = 1000,
  n_cores = NULL
)
}
\arguments{
\item{Y}{Response matrix (e.g., site x species matrix). Either Y or Y_diss must be provided.}

\item{Y_diss}{Pre-calculated dissimilarity values between site pairs. If provided, D must also be supplied. Either Y or Y_diss must be provided.}

\item{Y_den}{Denominator values for Jaccard, SÃ¸rensenensen or Bray-Curtis dissimilarities when using Y_diss. Required when family = "binomial" and Y_diss is provided.}

\item{D}{Data frame or matrix with two columns specifying site pairs (indices) corresponding to Y_diss values. Only required when Y_diss is provided.}

\item{X}{Data frame containing predictor variables as site-level values.}

\item{X_pair}{Data frame containing predictor variables as pairwise distances.}

\item{diss_formula}{Formula specifying predictors for dissimilarity gradients. All variables must be numeric. \code{isp()} can be used in combination with \code{mono = TRUE} to fit monotonic I-splines (e.g., \code{~ isp(elevation) + isp(temperature)}).}

\item{uniq_formula}{Formula specifying predictors and random effects for uniqueness. Uses lme4-style syntax for random effects (e.g., \code{~ treatment + (1|site)}).}

\item{mono}{Logical. If \code{TRUE}, enforces monotonic (non-decreasing) dissimilarity effects on predictors included in \code{diss_formula}. Default is \code{FALSE}.}

\item{mono_pair}{Logical. If \code{TRUE}, enforces monotonic (non-decreasing) dissimilarity effects on predictors included in \code{pair_formula}. Default is \code{FALSE}.}

\item{family}{Distribution family for the response. One of \code{"normal"}, \code{"binomial"}, or \code{"beta"}. Default is \code{"normal"}.}

\item{link}{Link function. If \code{NULL} (default), automatically chosen based on family: \code{"identity"} for normal, \code{"logit"} for binomial/beta.}

\item{scale_diss}{Numeric vector of length 2 specifying the range of the re-scaling of dissimilarity values. Useful when using a beta distribution if some dissimilarities are exactly 0 and/or 1.}

\item{binary}{Logical. Whether to treat response as binary data before calculating dissimilarities from Y. Default is \code{FALSE}.}

\item{method}{Dissimilarity method applied to Y. See \href{https://rdrr.io/cran/vegan/man/vegdist.html}{\code{vegan::vegdist()}} for a list of compatible methods. Default is \code{"bray"}.}

\item{control}{List of control parameters passed to nlminb optimizer (e.g., \code{control = list(rel.tol = 1e-8, iter.max = 500)}).}

\item{trace}{Logical. If \code{TRUE}, prints information during optimization. Default is \code{FALSE}.}

\item{bboot}{Logical. If \code{TRUE}, performs Bayesian bootstrapping. Default is \code{FALSE}.}

\item{n_boot}{Integer. Number of bootstrap samples when \code{bboot = TRUE}. Default is 1000.}

\item{n_cores}{Integer. Number of cores for parallel processing during bootstrapping. If \code{NULL}, uses \code{detectCores() - 2}.}
}
\value{
For \code{bboot = FALSE}: An object of class "gdmm" containing model fit, parameters, and diagnostics.
For \code{bboot = TRUE}: An object of class "bbgdmm" containing bootstrap samples and model information.
}
\description{
Fits a generalized dissimilarity mixed model (gdmm) for ecological community data.
The model can estimate the effect of predictors on community dissimilarity
and uniqueness simultaneously.

The function supports two options for estimation:
\itemize{
\item Hierarchical structure via site-level random effects in \code{uniq_formula} (e.g., \code{~ ... + (1|site)}).
\item Bayesian bootstrapping (\code{bboot = TRUE}) to obtain site-level uncertainty in parameter estimates.
}

Dissimilarity gradients are specified in \code{diss_formula}, which may include non-linear transformations
such as monotonic I-splines (\code{isp(x)} with \code{mono = TRUE}) to allow flexible monotonic responses.

Direct effects on community uniqueness are supported via \code{uniq_formula}.
}
