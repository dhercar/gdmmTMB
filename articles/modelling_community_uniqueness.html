<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modelling community uniqueness with `gdmmTMB` • gdmmTMB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling community uniqueness with `gdmmTMB`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdmmTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/modelling_community_uniqueness.html">Modelling community uniqueness with `gdmmTMB`</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modelling community uniqueness with `gdmmTMB`</h1>
            
      

      <div class="d-none name"><code>modelling_community_uniqueness.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dhercar.github.io/gdmmTMB/">gdmmTMB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Although the response variable in a Generalised Dissimilarity Model
(GDM) is a pairwise dissimilarity, <code>gdmmTMB</code> can also handle
effects on community uniqueness that are mathematically equivalent to
those in models where uniqueness metrics, such as the Local Contribution
to Beta Diversity (LCBD), are the response.</p>
<p>This vignette showcases the usage of <code>gdmmTMB</code> to model
community uniqueness using the dataset <code>microbialdata</code>
available as part of the <code>gllvm</code> R package. The dataset
contains the matrices <code>Y</code>, which contains abundances of over
900 species found across 56 microbial communities, and
<code>Xenv</code>, which consists of multiple environmental variables
measured at each site</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="fu">gllvm</span><span class="fu">::</span><span class="va"><a href="https://jenniniku.github.io/gllvm/reference/microbialdata.html" class="external-link">microbialdata</a></span><span class="op">$</span><span class="va">Xenv</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">gllvm</span><span class="fu">::</span><span class="va"><a href="https://jenniniku.github.io/gllvm/reference/microbialdata.html" class="external-link">microbialdata</a></span><span class="op">$</span><span class="va">Y</span></span></code></pre></div>
<p>For the purpose of this example, we focus on <code>pH</code> as the
main driver of community variability.</p>
<div class="section level2">
<h2 id="modelling-linear-effects-on-community-uniqueness">Modelling linear effects on community uniqueness<a class="anchor" aria-label="anchor" href="#modelling-linear-effects-on-community-uniqueness"></a>
</h2>
<p>Community uniqueness is often modelled as the Local Contribution to
Beta Diversity <span class="citation">(Legendre and De Cáceres
2013)</span>. A common approach is to (1) compute LCBD scores from a
dissimilarity matrix and (2) model LCBD scores as independent
observations.</p>
<p>The code below computes LCBD scores using the package
<code>adespatial</code> <span class="citation">(Dray et al.
2018)</span>, and regresses them against pH and the quadratic pH
term.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">LCBD</span> <span class="op">&lt;-</span> <span class="fu">adespatial</span><span class="fu">::</span><span class="fu"><a href="http://adeverse.github.io/adespatial/reference/LCBD.comp.html" class="external-link">LCBD.comp</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://vegandevs.github.io/vegan/reference/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">LCBD</span> <span class="op">&lt;-</span> <span class="va">LCBD</span><span class="op">$</span><span class="va">LCBD</span></span>
<span></span>
<span><span class="va">m_lcbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">LCBD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">pH</span>,<span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Xenv</span><span class="op">)</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">pred_lcbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_lcbd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Xenv</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pH</span>, y <span class="op">=</span> <span class="va">LCBD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred_lcbd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
<p>In brief, effects on LCBD denote increasing or decreasing expected
dissimilarity of each community to all other communities. The U-shaped
relationship therefore indicates that communities at the extremes of the
pH gradient are more dissimilar on average to all other communities, and
therefore more unique.</p>
<p>We can obtain the exact same relationship by modelling pairwise
dissimilarities directly, by introducing site-level effects (see <span class="citation">Hernández-Carrasco et al. (2025)</span> for details).
This can be done in <code>gdmmTMB</code> via the
<code>uniq_formula</code> argument:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit model</span></span>
<span><span class="va">m_gdmm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/gdmm.html">gdmm</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>       X <span class="op">=</span> <span class="va">Xenv</span>,</span>
<span>       uniq_formula <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">pH</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: the 'nobars' function has moved to the reformulas package. Please update your imports, or ask an upstream package maintainter to do so.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span></span>
<span><span class="co"># generate predictions</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">pred_gdmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_gdmm</span>, component <span class="op">=</span> <span class="st">'uniqueness'</span>, scale_uniq <span class="op">=</span> <span class="cn">TRUE</span>, CI <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot relationship</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Xenv</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pH</span>, y <span class="op">=</span> <span class="va">LCBD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred_gdmm</span>, col <span class="op">=</span> <span class="st">'gdmm'</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred_lcbd</span>, col <span class="op">=</span> <span class="st">'lcbd'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="700"></p>
<p>Both models produce the exact same U-shaped relationship between
<code>pH</code> and <code>LCBD</code>. However, modelling effects on
uniqueness with pairwise dissimilarities allows accounting for the
distribution of such dissimilarities with a more appropriate error
distribution link function. For instance, a binomial error distribution
can be specified via the <code>family</code> argument. We can also
account for the non-independence of pairwise dissimilarities with a
site-level random effect (<code>uniq_formula = ~ ... + (1|site)</code>),
or with Bayesian bootstrapping (<code>bboot = TRUE</code>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Xenv</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># site-level random effect</span></span>
<span><span class="va">m_gdmm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdmm.html">gdmm</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  X <span class="op">=</span> <span class="va">Xenv</span>,</span>
<span>  uniq_formula <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">pH</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'binomial'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bayesian bootstrapping</span></span>
<span><span class="va">m_gdmm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdmm.html">gdmm</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  X <span class="op">=</span> <span class="va">Xenv</span>,</span>
<span>  uniq_formula <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">pH</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'binomial'</span>,</span>
<span>  bboot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="accounting-for-directional-community-changes">Accounting for directional community changes<a class="anchor" aria-label="anchor" href="#accounting-for-directional-community-changes"></a>
</h2>
<p>The U-shaped relationship between LCBD and pH above indicates that
sites with low and high pH host relatively more unique species. However,
a representation of the variability in community composition reveals a
strong directional change in community composition along the pH
gradient.</p>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="700"></p>
<p>Sites at either end of the pH gradient are therefore further from the
centroid (i.e., they present a higher average dissimilarity to all other
sites), which could underpin the U-shaped relationship between LCBD and
pH. We refer to the contribution of directional changes in community
composition to the observed beta diversity patterns as ‘directional
effects’. Directional effects can be accounted for by making the
expected dissimilarity between sites a function of their environmental
distance <span class="citation">(Mokany et al. 2022)</span>. In
<code>gdmmTMB</code>, these directional effects are introduced via the
<code>diss_formula</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_gdmm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gdmm.html">gdmm</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  X <span class="op">=</span> <span class="va">Xenv</span>,</span>
<span>  uniq_formula <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">pH</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  diss_formula <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="../reference/isp.html">isp</a></span><span class="op">(</span><span class="va">pH</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'binomial'</span>,</span>
<span>  bboot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mono <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>diss_gradient</code> function can be used to visualise
dissimilarity gradients.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diss_grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diss_gradient.html">diss_gradient</a></span><span class="op">(</span><span class="va">m_gdmm3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">diss_grad</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">f_x</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`CI 2.5%`</span>, ymax <span class="op">=</span> <span class="va">`CI 97.5%`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'pH'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'f(pH)'</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="700"></p>
<p>We can also use the <code>predict</code> method to visualise the new
expected relationship between pH and LCBD, and the contributions of each
model component (directional and non-directional effects):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata_mean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">pH</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predict_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_gdmm3</span>, new_X <span class="op">=</span> <span class="va">Xenv</span>, new_W <span class="op">=</span> <span class="va">Xenv</span>, component <span class="op">=</span> <span class="st">'uniqueness'</span><span class="op">)</span>, </span>
<span>  pH <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">pH</span>,</span>
<span>  LCBD <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">LCBD</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predict_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_gdmm3</span>, new_X <span class="op">=</span> <span class="va">Xenv</span>, new_W <span class="op">=</span> <span class="va">newdata_mean</span>, component <span class="op">=</span> <span class="st">'uniqueness'</span><span class="op">)</span>, </span>
<span>  pH <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">pH</span>,</span>
<span>  LCBD <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">LCBD</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predict_nondir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_gdmm3</span>, new_X <span class="op">=</span> <span class="va">newdata_mean</span>, new_W <span class="op">=</span> <span class="va">Xenv</span>, component <span class="op">=</span> <span class="st">'uniqueness'</span><span class="op">)</span>, </span>
<span>  pH <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">pH</span>,</span>
<span>  LCBD <span class="op">=</span> <span class="va">Xenv</span><span class="op">$</span><span class="va">LCBD</span><span class="op">)</span></span></code></pre></div>
<p><img src="modelling_community_uniqueness_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dray2018package" class="csl-entry">
Dray, Stéphane, Guillaume Blanchet, Daniel Borcard, Guillaume Guenard,
Thibaut Jombart, Guillaume Larocque, Pierre Legendre, Naima Madi, Helene
H Wagner, and Maintainer Stéphane Dray. 2018. <span>“Package
<span>‘Adespatial’</span>.”</span> <em>R Package</em> 2018: 3–8.
</div>
<div id="ref-hernandez2025accounting" class="csl-entry">
Hernández-Carrasco, Daniel, Anthony J Gillis, Hao Ran Lai, Tadeu
Siqueira, and Jonathan D Tonkin. 2025. <span>“Accounting for the
Influence of Dissimilarity Gradients on Community Uniqueness.”</span>
<em>bioRxiv</em>, 2025–09.
</div>
<div id="ref-legendre2013beta" class="csl-entry">
Legendre, Pierre, and Miquel De Cáceres. 2013. <span>“Beta Diversity as
the Variance of Community Data: Dissimilarity Coefficients and
Partitioning.”</span> <em>Ecology Letters</em> 16 (8): 951–63.
</div>
<div id="ref-mokany2022working" class="csl-entry">
Mokany, Karel, Chris Ware, Skipton NC Woolley, Simon Ferrier, and
Matthew C Fitzpatrick. 2022. <span>“A Working Guide to Harnessing
Generalized Dissimilarity Modelling for Biodiversity Analysis and
Conservation Assessment.”</span> <em>Global Ecology and
Biogeography</em> 31 (4): 802–21.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Hernandez-Carrasco.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
